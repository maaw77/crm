# CRM
Набор инструментов, обеспечивающих автоматизированные: извлечение данных (ресурсов) с конечных точек веб-приложения 
(учет горюче-смазочных материалов); анализ, обработку и  сохранение данных (ресурсов) в базу данных
## Особенности
Проект реализован с применением принципов асинхронного программирования на Python.
## Установка и запуск 
1. Установить docker и docker-compose.
Инструкция по установке доступна в официальной документации
2. В папке с проектом создать файл `.env`, содержащий параметры соединения с сервером PostgreSQL и
учетные данные пользователя в системе ГСМ.<br>
_Пример:_
```
POSTGRES_DB=postgres
POSTGRES_USER=postgres
POSTGRES_PASSWORD=************
HOST_DB=db
PORT_DB=5432

crm_username=USER_222 # учетные данные пользователя в системе ГСМ
crm_password=******* # учетные данные пользователя в системе ГСМ
```
3. В папке с проектом выполнить команду
```commandline
docker-compose up
```
## Применение
### Инициализации базы данных 
(Для более подробной информации введите команду:```python -m dbase.init_db -h```)
```commandline
python -m dbase.init_db init
```
### Очистка базы данных
```commandline
python -m dbase.init_db delete
```
### Загрузка данных (ресурсов) в базу данных
```commandline
python -m  dbase.loaddata
```
### Запуск бота
```commandline
python crmbot/crmbot.py
```
Бот сканирует конечные точки веб-приложения и сохраняет новые данные (ресурсы) в базу данных.
Автоматически запускает сканирование в 23:00 каждый день.<br>
_Примечание: Инициализации базы данных, загрузка данных (ресурсов) в базу данных, запуск бота выполняются автоматически
при запуске контейнера crmbot._
###  Вывод данных из базы данных в стандартный поток вывода
Для более подробной информации введите команду: `docker exec crmbot python -m dbase.dumpdata -h`<br>
_Пример:_ 
 ```commandline
docker exec crmbot python -m dbase.dumpdata gsm 2024-05-01 2024-06-01
 ```
###  Запуск тестов
 ```commandline
docker exec pytest -v tests/
 ```